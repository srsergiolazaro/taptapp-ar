---
interface Props {
  targetImage?: string;
}

const { targetImage } = Astro.props;
---

<div
  id="scanning-overlay"
  class="custom-overlay relative flex flex-col items-center justify-center"
>
  <div class="scan-region relative mb-8 h-[300px] w-[300px] overflow-hidden">
    <!-- Esquinas del recuadro de escaneo -->
    <div class="corner top-left"></div>
    <div class="corner top-right"></div>
    <div class="corner bottom-left"></div>
    <div class="corner bottom-right"></div>

    <div class="absolute inset-0 p-6">
      <img id="target-preview" src={targetImage} class="h-full w-full object-contain opacity-90" />
    </div>

    <div class="scan-animation"></div>
  </div>

  <div class="font-semibold tracking-wide text-white/95 text-2xl">Escaneando...</div>
  <div class="mt-3 max-w-[80%] text-center font-light text-white/75 text-sm">
    Centre el sticker dentro del marco
  </div>
</div>

<style>
  .scan-region img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    opacity: 0.7;
  }

  .scan-animation {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(
      90deg,
      rgba(52, 152, 219, 0),
      rgba(52, 152, 219, 0.8),
      rgba(155, 89, 182, 0.8),
      rgba(52, 152, 219, 0)
    );
    box-shadow:
      0 0 10px rgba(52, 152, 219, 0.7),
      0 0 20px rgba(155, 89, 182, 0.4);
    animation: scan 2.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
  }

  @keyframes scan {
    0% {
      transform: translateY(0);
      opacity: 0.8;
    }
    15% {
      opacity: 1;
    }
    50% {
      transform: translateY(298px);
      opacity: 1;
    }
    85% {
      opacity: 0.8;
    }
    100% {
      transform: translateY(0);
      opacity: 0.8;
    }
  }

  /* Estilos para las esquinas */
  .corner {
    position: absolute;
    width: 24px;
    height: 24px;
    border-color: white;
    border-style: solid;
    opacity: 0.7;
    z-index: 1;
  }

  .top-left {
    top: 6px;
    left: 6px;
    border-width: 2px 0 0 2px;
    border-top-left-radius: 6px;
  }

  .top-right {
    top: 6px;
    right: 6px;
    border-width: 2px 2px 0 0;
    border-top-right-radius: 6px;
  }

  .bottom-left {
    bottom: 6px;
    left: 6px;
    border-width: 0 0 2px 2px;
    border-bottom-left-radius: 6px;
  }

  .bottom-right {
    bottom: 6px;
    right: 6px;
    border-width: 0 2px 2px 0;
    border-bottom-right-radius: 6px;
  }
</style>
